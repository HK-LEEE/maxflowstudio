# FlowStudio 사용법 가이드

FlowStudio는 시각적 워크플로우 디자인 플랫폼으로, 노드 기반의 인터페이스를 통해 복잡한 작업 플로우를 직관적으로 설계하고 실행할 수 있습니다.

## 🚀 시작하기

### 1. 새 플로우 생성
1. 좌측 사이드바에서 "새 플로우" 버튼 클릭
2. 플로우 이름 입력 (예: "고객 데이터 처리 워크플로우")
3. "저장" 버튼을 클릭하여 플로우 생성

### 2. 기본 화면 구성
- **헤더**: 플로우 이름, 저장/테스트/배포 버튼
- **좌측 패널**: 노드 팔레트 (사용 가능한 노드 타입들)
- **중앙 캔버스**: 플로우 디자인 영역
- **우측 패널**: 선택된 노드의 설정 창 (3단계 크기 조절 가능)

## 🎨 캔버스 조작법

### 기본 조작
- **마우스 드래그**: 캔버스 이동 (팬)
- **마우스 휠**: 확대/축소 (줌)
- **더블클릭**: 줌 인
- **노드 드래그**: 노드 위치 이동
- **빈 공간 클릭**: 선택 해제

### 캔버스 이동 제한
- 노드가 있는 영역 주변에서만 이동 가능
- 노드를 화면 중앙에 배치할 수 있도록 충분한 여백 제공
- 스크롤바 없이 순수 드래그 방식으로 탐색

## 🔧 노드 작업

### 노드 추가
1. 좌측 노드 팔레트에서 원하는 노드 타입 선택
2. 캔버스로 드래그 앤 드롭
3. 노드가 자동으로 생성됨

### 노드 연결
1. 시작 노드의 출력 핸들 클릭
2. 대상 노드의 입력 핸들로 드래그
3. 연결선이 자동으로 생성됨

### 노드 삭제
1. 삭제할 노드 클릭하여 선택
2. 화면 하단에 나타나는 빨간색 "Delete Node" 버튼 클릭
3. 확인 없이 즉시 삭제됨 (연결된 간선도 함께 삭제)

### 노드 복사/붙여넣기
- **복사**: `Ctrl + C`
- **붙여넣기**: `Ctrl + V`
- 복사된 노드는 화면 중앙에 배치됨

## ⚙️ 노드 설정

### 노드 설정창 조작
우측 패널의 3단계 토글 시스템:
1. **좁게 (320px)**: 기본 크기
2. **넓게 (640px)**: 넓은 설정 화면
3. **닫기**: 패널 완전 숨김

### 주요 노드 타입별 설정

#### 🔤 Template Node
- **템플릿 문자열**: `안녕하세요 {Variable1}님, 오늘의 주제는 {Variable2}입니다.`
- **변수 처리 모드**: 단순/고급 모드 선택
- **정의되지 않은 변수 처리**: 빈 문자열/오류/기본값 중 선택

#### 🌐 API Call Node
- **URL**: API 엔드포인트 주소
- **HTTP 메서드**: GET, POST, PUT, DELETE 선택
- **인증**: Bearer Token, Basic Auth, API Key 중 선택
- **헤더**: 요청 헤더 추가
- **바디**: JSON 요청 데이터 (POST/PUT 시)

#### ⚡ Function Node (Python 전용)
- **코드 에디터**: Monaco Editor를 통한 Python 코드 작성
- **허용된 모듈**: json, math, datetime, time, re, random 등
- **보안 제한**: 파일 시스템 접근 및 네트워크 차단
- **입력 변수**: `input_data`로 접근
- **출력**: `return` 문으로 결과 반환

#### 🔀 Condition Node
- **조건 타입**: 17가지 조건 타입 지원
  - 기본 비교: 같음, 다름, 크기 비교
  - 문자열: 포함, 시작/끝, 정규식
  - 고급: JSONPath, 배열 포함 등
- **값 비교**: 왼쪽 값, 조건, 오른쪽 값 설정
- **대소문자 구분**: 문자열 비교 시 옵션

## 🔐 환경변수 관리

### 환경변수 설정
1. 우측 설정 패널에서 "환경변수 관리" 버튼 클릭
2. "환경변수 추가" 버튼으로 새 변수 생성
3. 키, 값, 타입, 카테고리 설정

### 변수 타입
- **문자열**: 일반 텍스트
- **보안 문자열**: 암호화되어 저장되는 민감 정보
- **URL**: 웹 주소
- **숫자**: 수치 데이터
- **불린**: true/false 값

### 변수 사용
노드 설정에서 `{VARIABLE_NAME}` 형태로 참조:
```
API URL: {API_BASE_URL}/users
Authorization: Bearer {API_TOKEN}
```

## 📊 플로우 실행 및 테스트

### 테스트 실행
1. 플로우 저장 후 "Test" 버튼 클릭
2. 우측에 채팅 패널 표시
3. 실시간으로 노드 실행 상태 확인:
   - **파란색 테두리**: 실행 중
   - **초록색 테두리**: 완료
   - **빨간색 테두리**: 오류 발생

### 실행 결과 확인
- 각 노드의 실행 결과를 채팅 패널에서 확인
- 오류 발생 시 상세 에러 메시지 표시
- 플로우 전체 실행 시간 및 성공/실패 통계

## 📦 버전 관리 및 배포

### 버전 관리
1. "Version" 버튼 클릭하여 버전 히스토리 확인
2. 각 저장 시점마다 자동으로 새 버전 생성
3. 이전 버전으로 롤백 가능

### 플로우 배포
1. 플로우 완성 후 "Publish" 버튼 클릭
2. 시스템이 자동으로:
   - 현재 상태를 새 버전으로 저장
   - 최신 버전을 배포용으로 설정
   - **자동으로 Deployment 생성** (새 기능!)
   - API 엔드포인트 생성 및 표시
3. 배포된 플로우는 프로덕션 환경에서 실행 가능

### Deployment 관리 (새 기능!)
1. **Deploy 버튼**: 헤더의 "Deploy" 버튼 클릭 (배지에 deployment 개수 표시)
2. **Deployment 목록 확인**:
   - 현재 플로우의 모든 deployment 조회
   - 각 deployment의 상태 (running/stopped/pending) 확인
   - 버전 정보 및 생성 시간 표시

3. **API 엔드포인트 관리**:
   - "Copy API" 버튼으로 API 주소 복사
   - 형식: `/api/deployments/{deployment_id}/execute`
   - 클립보드에 자동 복사됨

4. **Deployment 제어**:
   - **Start**: 중지된 deployment 시작
   - **Stop**: 실행 중인 deployment 중지
   - **View Details**: api-deployments 페이지에서 상세 정보 확인

### 배포 후 API 사용
Publish 성공 시 표시되는 정보:
```
🚀 Deployment Created!
• Name: My Flow - v1
• Status: running
• API: /api/deployments/abc123/execute
• View in deployments: http://localhost:3005/api-deployments
```

실제 API 호출 예시:
```bash
curl -X POST http://localhost:8000/api/deployments/abc123/execute \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"input_data": {"key": "value"}}'
```

## 💡 팁과 요령

### 효율적인 워크플로우 설계
1. **단순함 유지**: 복잡한 로직은 여러 노드로 분할
2. **명확한 명명**: 노드와 변수에 의미 있는 이름 사용
3. **오류 처리**: Condition 노드로 예외 상황 대비
4. **테스트**: 각 단계별로 점진적 테스트

### 성능 최적화
- 불필요한 API 호출 최소화
- Function 노드에서 반복문 사용 시 주의
- 큰 데이터 처리 시 여러 단계로 분할

### 보안 모범 사례
- API 키와 토큰은 반드시 환경변수로 관리
- 민감한 데이터는 보안 환경변수 타입 사용
- Function 노드에서 외부 라이브러리 임포트 금지

## 🆘 문제 해결

### 일반적인 문제
1. **노드 연결 실패**: 핸들이 정확히 정렬되었는지 확인
2. **환경변수 인식 안됨**: 변수명이 정확한지, 저장되었는지 확인
3. **API 호출 실패**: URL과 인증 정보 재확인
4. **Function 실행 오류**: Python 문법과 허용된 모듈 사용 확인

### 캔버스 조작 문제
- 노드가 화면 밖으로 사라진 경우: Fit View 버튼 클릭
- 줌이 너무 확대/축소된 경우: 더블클릭으로 리셋
- 패널이 사라진 경우: 우측 가장자리의 설정 버튼 확인

---

이 가이드를 통해 FlowStudio의 모든 기능을 효과적으로 활용하여 강력한 워크플로우를 설계하고 배포할 수 있습니다. 추가 질문이나 기능 요청은 개발팀에 문의해 주세요.